<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>YouTube Playlist Dashboard</title>
  <style>
    :root{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;}
    body{margin:0;padding:20px;background:#f6f7fb;color:#111}
    .card{max-width:1000px;margin:0 auto;background:#fff;border-radius:12px;padding:20px;box-shadow:0 6px 24px rgba(20,20,50,0.08)}
    h1{font-size:22px;margin:0 0 14px}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
    input[type=text]{flex:1;min-width:220px;padding:10px;border-radius:8px;border:1px solid #ddd}
    input[type=number]{width:110px;padding:10px;border-radius:8px;border:1px solid #ddd}
    .btn{padding:10px 14px;border-radius:8px;border:0;background:#2563eb;color:#fff;cursor:pointer}
    .btn.secondary{background:#6b7280}
    .btn.danger{background:#dc2626}
    .note{font-size:13px;color:#555;margin-top:6px}
    .preview{margin-top:18px}
    .embed-wrap{position:relative;padding-top:56.25%;background:#000;border-radius:8px;overflow:hidden}
    iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}
    .error{color:#b91c1c;margin-top:8px}
    .row{display:flex;gap:8px;align-items:center}
    label{font-size:14px}
    .small{font-size:13px;color:#666}
    ul.playlist{list-style:none;padding:0;margin:0;max-height:200px;overflow:auto;border:1px solid #ddd;border-radius:8px}
    ul.playlist li{padding:8px 10px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
    ul.playlist li:last-child{border-bottom:none}
    ul.playlist button{font-size:12px;padding:6px 10px}
  </style>
</head>
<body>
  <div class="card">
    <h1>YouTube Playlist Dashboard</h1>
    <p class="note">Paste YouTube URLs, build a temporary playlist, and play them inside this page. Nothing is saved permanently.</p>

    <div class="controls">
      <input id="urlInput" type="text" placeholder="https://www.youtube.com/watch?v=..." />
      <input id="startInput" type="number" min="0" placeholder="start (seconds)" />
      <label class="row small"><input id="autoplay" type="checkbox" /> Autoplay</label>
      <button id="addBtn" class="btn">Add to Playlist</button>
    </div>

    <h3>Playlist</h3>
    <ul id="playlist" class="playlist"></ul>

    <div class="preview">
      <div id="embedArea" class="embed-wrap" style="display:none"></div>
    </div>

    <div id="error" class="error" role="alert" aria-live="polite"></div>
  </div>

  <script>
    async function fetchTitle(videoId){
      try{
        const resp = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`);
        if(!resp.ok) return videoId;
        const data = await resp.json();
        return data.title || videoId;
      }catch(e){
        return videoId;
      }
    }

    function getYouTubeID(url){
      if(!url || typeof url !== 'string') return null;
      url = url.trim();
      if(/^[A-Za-z0-9_-]{11}$/.test(url)) return url;
      try{
        const u = new URL(url);
        if(u.hostname === 'youtu.be') return u.pathname.slice(1) || null;
        if(u.hostname.includes('youtube.com')){
          const v = u.searchParams.get('v');
          if(v) return v;
          const parts = u.pathname.split('/').filter(Boolean);
          const embedIndex = parts.indexOf('embed');
          if(embedIndex !== -1 && parts[embedIndex+1]) return parts[embedIndex+1];
          const maybe = parts[parts.length-1];
          if(maybe && /^[A-Za-z0-9_-]{11}$/.test(maybe)) return maybe;
        }
      }catch(e){}
      const regex = /(?:v=|\/embed\/|youtu\.be\/)([A-Za-z0-9_-]{11})/;
      const m = url.match(regex);
      return m ? m[1] : null;
    }

    const urlInput = document.getElementById('urlInput');
    const startInput = document.getElementById('startInput');
    const autoplayCheckbox = document.getElementById('autoplay');
    const addBtn = document.getElementById('addBtn');
    const embedArea = document.getElementById('embedArea');
    const errorEl = document.getElementById('error');
    const playlistEl = document.getElementById('playlist');

    let playlist = [];

    function showError(msg){ errorEl.textContent = msg; }
    function clearError(){ errorEl.textContent = ''; }

    function buildEmbedUrl(id, startSeconds, autoplay){
      let url = 'https://www.youtube.com/embed/' + encodeURIComponent(id);
      const params = new URLSearchParams();
      if(startSeconds && Number(startSeconds) > 0) params.set('start', Math.max(0, Math.floor(Number(startSeconds))));
      if(autoplay) params.set('autoplay', '1');
      params.set('enablejsapi','1');
      const qs = params.toString();
      if(qs) url += '?' + qs;
      return url;
    }

    async function renderPlaylist(){
      playlistEl.innerHTML = '';
      for(let i=0;i<playlist.length;i++){
        const item = playlist[i];
        const li = document.createElement('li');
        const title = item.title || await fetchTitle(item.id);
        item.title = title;

        li.innerHTML = `<span>${title}</span>`;
        const btns = document.createElement('div');

        const playBtn = document.createElement('button');
        playBtn.textContent = 'Play';
        playBtn.className = 'btn secondary';
        playBtn.addEventListener('click', ()=> playVideo(item));

        const delBtn = document.createElement('button');
        delBtn.textContent = 'Remove';
        delBtn.className = 'btn danger';
        delBtn.addEventListener('click', ()=>{
          playlist.splice(i,1);
          renderPlaylist();
        });

        btns.appendChild(playBtn);
        btns.appendChild(delBtn);
        li.appendChild(btns);
        playlistEl.appendChild(li);
      }
    }

    function playVideo(item){
      embedArea.innerHTML = '';
      const iframe = document.createElement('iframe');
      iframe.src = buildEmbedUrl(item.id, item.start, item.autoplay);
      iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
      iframe.allowFullscreen = true;
      embedArea.appendChild(iframe);
      embedArea.style.display = 'block';
    }

    addBtn.addEventListener('click', async ()=>{
      clearError();
      const id = getYouTubeID(urlInput.value);
      if(!id){ showError('Invalid YouTube URL or ID'); return; }
      const title = await fetchTitle(id);
      playlist.push({ id, start: startInput.value, autoplay: autoplayCheckbox.checked, title });
      renderPlaylist();
      urlInput.value = '';
      startInput.value = '';
      autoplayCheckbox.checked = false;
    });
  </script>
</body>
</html>
